<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sbe:messageSchema xmlns:sbe="http://fixprotocol.io/2016/sbe"
  package="io.scalecube.metrics.sbe"
  id="100"
  version="1"
  semanticVersion="5.2"
  description="Message Codecs for messages"
  byteOrder="littleEndian">

  <types>
    <composite name="messageHeader" description="Message identifiers and length of message root">
      <type name="blockLength" primitiveType="uint16"/>
      <type name="templateId" primitiveType="uint16"/>
      <type name="schemaId" primitiveType="uint16"/>
      <type name="version" primitiveType="uint16"/>
    </composite>

    <composite name="groupSizeEncoding" description="Repeating group dimensions">
      <type name="blockLength" primitiveType="uint16"/>
      <type name="numInGroup" primitiveType="uint16"/>
    </composite>

    <composite name="VarData">
      <type name="length" primitiveType="uint16" semanticType="Length"/>
      <type name="varData" length="0" primitiveType="uint8" semanticType="data"/>
    </composite>

    <composite name="String" description="Variable length ASCII String">
      <type name="length" primitiveType="uint16"/>
      <type name="varData" primitiveType="uint8" length="0" characterEncoding="US-ASCII"/>
    </composite>

    <!-- Enums -->

    <enum name="ValueType" encodingType="int8">
      <validValue name="BYTE">1</validValue>
      <validValue name="SHORT">2</validValue>
      <validValue name="INT">3</validValue>
      <validValue name="LONG">4</validValue>
      <validValue name="DOUBLE">5</validValue>
      <validValue name="STRING">6</validValue>
    </enum>
  </types>

  <!-- System messages -->

  <sbe:message name="Key" id="10">
    <group name="tags" id="100">
      <field name="valueType" id="101" type="ValueType"/>

      <data name="tag" id="102" type="String"/>
      <data name="value" id="103" type="VarData"/>
    </group>
  </sbe:message>

  <!-- Metrics messages -->

  <sbe:message name="Histogram" id="100">
    <field name="timestamp" id="1" type="int64"/>
    <field name="highestTrackableValue" id="2" type="int64"/>
    <field name="conversionFactor" id="3" type="double"/>

    <data name="key" id="100" type="VarData"/>
    <data name="accumulated" id="101" type="VarData"/>
    <data name="distinct" id="102" type="VarData"/>
  </sbe:message>

  <sbe:message name="Tps" id="101">
    <field name="timestamp" id="1" type="int64"/>
    <field name="value" id="2" type="int64"/>

    <data name="key" id="100" type="VarData"/>
  </sbe:message>

</sbe:messageSchema>
